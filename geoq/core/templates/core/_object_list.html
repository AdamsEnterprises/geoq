{% load object_class %}
<ul class="projectlist">

    {% if not object_list and not completed %}
        <div class="row body">
        {% if 'accounts.add_job' in request.base_perms %}
            <span><b>Next step: </b> <a class="btn btn-large btn-success" href="{% url 'job-create-aois' job_pk=object.id %}">Create workcells</a></span>
        {% else %}
            <span><b>This project doesn't have any jobs yet, please ask a supervisor to create one</b></span>
        {% endif %}
        </div>
    {% endif %}


    {# Currently only for job detail, 'in work' tab. #}
    {% with object_list|first as first_object %}
        {% if first_object.status == 'In work'%}
                {% include "core/_get_started_message.html" %}
        {% endif %}
    {% endwith %}

    {% for object in object_list %}
        {% with object_type=object|object_class|lower %}

        <li{% if object.status == 'In work' %}{% if request.user != object.analyst %} class='shaded'{% endif %}{% endif %}>

        {% if object_type == "project" %}
            {% include "core/_project_stat_list.html" %}
        {% elif object_type == "job" %}
            {% include "core/_job_stat_list.html" %}
        {% elif object_type == "aoi" %}
            {% include "core/_aoi_stat_list.html" %}
        {% endif %}
        <h3 style="display: inline-block; margin:0px">
            <i class="icon-{% if object_type == "project" %}briefcase{% elif object_type == "job"%}inbox{% elif object_type == "aoi"%}th{% endif %} icon-1x pull-left list-icon"></i>
            <span class="title pull-left">
                {% if object.status == 'In work' %}
                    {% if request.user == object.analyst %}
                    <a href="{{ object.get_absolute_url|default:'#' }}">
                    {% endif %}
                {% else %}
                    <a href="{{ object.get_absolute_url|default:'#' }}">
                {% endif %}

                {{ object.name }} {% if object_type == "aoi" %}{{ object.id }}{% endif %}

                {% if object.status == 'In work' %}{% if request.user == object.analyst %}
                </a>
                {% endif %}{% else %}
                </a>
                {% endif %}
            </span>
        </h3>


        <p class="body project-description">{{ object.description }}</p>

        <p class="body muted timestamp">{{ object.created_at }}</p>

        {% if object_type == "job" %}
            {{ object.features_table_html|safe }}
        {%  endif %}

        </li>
    {% endwith %}
    {% endfor %}

    {% if object_list %}
    {% include 'core/_pagination.html' with page=page_obj alignment='centered' %}
    {% endif %}

</ul>
